---
layout: post
category: Point
title: 【Point Cloud】点云上的卷积神经网络及其部分应用
tagline: by Qifan
author: 宇恒兄
tags: 
  - Point Net
published: true

---

# 问题背景
点云上做CNN的工作和点云上其他操作有些不同，点云CNN更偏重于识别的任务，目前市面上已经有了很多深度传感器，可以直接获得周围物体的深度数据，例如Velodyne LiDAR等，可见深度传感器在我们日常生活中将会变得更加普遍。


![image](https://cdn.jsdelivr.net/gh/ZhouKanglei/jidianxia/2021-3-26/1616756004474-image.png)

常见的三维表示形式有很多种，常见的表示形式为点云、Mesh、Volumetric和RGBD等。

- Mesh可以更好地表示物体表面信息；
- Volumetric是将三维空间转换成网格的表示形式；
- RGBD则在传统RGB图相中增加了一个深度维度的信息，但只能看到一个视角的信息。

研究点云CNN的一个重要原因是：不管是LiDAR、结构光还是TOF等深度传感器，都是直接获得的点云信息，而其他的三维表示都是由点云生成的。


![](https://cdn.jsdelivr.net/gh/ZhouKanglei/jidianxia/2021-3-26/1616756091701-image.png)

# 研究现状
先从2D图像出发，现在的技术可以用`image(i-1,j-1)`表示像素`image(i,j)`的邻域信息来表示图像中具体的位置信息，但是不能保证在点云中相同的相对位置处存在点云数据。于是可以把这个问题转成volumetric convolution来进行点云的CNN，但会出现不是所有Voxel都有特征点的情况，而有点的体素则可以找到该点的邻域进行计算。
将这种方法应用到点云中，近些年研究学者发现利用矩阵稀疏性可以起到提高计算速度的作用，精度和速度近些年已经取得了相当不错的结果。


![](https://cdn.jsdelivr.net/gh/ZhouKanglei/jidianxia/2021-3-26/1616756162383-image.png)

# 经典回顾
PointNet中常用的有两种操作：`1×1 convolution`和`Max-pooling`.
然而，只有这两种操作实际上对要求更加精确的3D识别来讲是远远不够的。PointNet提取特征的方式是对所有点云数据提取了一个全局的特征，显然和目前流行的CNN逐层提取局部特征的方式不一样。


![](https://cdn.jsdelivr.net/gh/ZhouKanglei/jidianxia/2021-3-26/1616756238603-image.png)

PointNet++更接近了传统的CNN，相较于PointNet，它能够在不同尺度提取局部特征，通过多层网络结构得到深层特征。

PointNet++由以下几个关键部分构成：`Sampling`（采样层），`Grouping`（组合层），`PointNet`（特征提取层）。


![](https://cdn.jsdelivr.net/gh/ZhouKanglei/jidianxia/2021-3-26/1616756297188-image.png)


# CNN 到 PointConv

虽然PointNet已经足够优秀，但是PointNet缺少邻域信息，与传统意义上通过周围邻域得到卷积结果十分不同，这也很难直接应用于后面的点云CNN中。

例如一个最简单的边缘检测的任务，在边缘处两边的颜色不同，为了检测出边缘，至少需要考虑两个点的颜色信息才能判断出是否存在边缘。而PointNet除了`Max Pooling`以外，剩下的所有操作都只对单点进行，很难直接应用到Corner Detection等任务中去，因此仍然需要真正意义上的点云CNN。

![](https://cdn.jsdelivr.net/gh/ZhouKanglei/jidianxia/2021-3-26/1616756349803-image.png)

对于2D图片来说，某个位置的输出，不仅与该位置的输入有关，还与此位置周边位置的输入有关，不同位置的输入，具有不同的权重。下图中`X(i,j,k)`可以看做图像的原始像素，$W$为卷积核，$G$为邻域。卷积是一个加权求和的操作，由于位置坐标的像素值是固定值，卷积核上所有作用点以此作用于原始图像像素，并通过线性叠加把所有的作用结果累加，即是图像卷积的输出。


![](https://cdn.jsdelivr.net/gh/ZhouKanglei/jidianxia/2021-3-26/1616756402713-image.png)

# PointConv: Deep Convolutional Networks on 3D Point Clouds

与用规则密集网格表示的图像不同，3D点云是不规则和无序的，因此对它们应用卷积可能很困难。本文将动态滤波器扩展为一种新的卷积运算，称为`PointConv`（可翻译为点卷积）。`PointConv`可以应用于点云，构建深度卷积网络。

本文将卷积核视为由权重和密度函数组成的3D点的局部坐标的非线性函数。对于给定点，权重函数通过多层感知器网络和密度函数通过核密度估计来学习。这项工作最重要的贡献是提出了一种新的重构方法来有效地计算权重函数，这能够显著地扩大网络规模并显著地提高其性能。

学习的卷积核可以用于计算三维空间中任意点集上的平移不变和排列不变卷积。此外，`PointConv`还可以用作反卷积运算符，从二次采样的点云背景到原始分辨率传播特征。在`ModelNet40`、`ShapeNet`和`ScanNet`上的实验表明，基于点云的深度卷积神经网络能够实现对3D点云语义分割基准的最先进的挑战。此外，文中将`CIFAR-10`转换为点云的实验表明，基于`PointConv`构建的网络可以在类似结构的2D图像中匹配卷积网络的性能。

文章创新点：
1. 提出了PointConv：PointConv是一种密度重加权卷积，它能够在任何一组3D点上完全逼近3D连续卷积。

2. 引入了一种有效提高存储效率的方法来实现PointConv，能够使用改变求和顺序的重构来大大提高存储器效率。最重要的是，它允许扩展到CNN的规模。该方法可以实现与2D卷积网络中相同的平移不变性，以及点云中点的排序的不变性。

3. 将PointConv扩展到反卷积`—PointDeconv`，获得更好的分割结果，而大多数先进算法不能实现反卷积操作。

## PointConv

两个连续函数 $f(x)$ 和 $g(x)$ 关于一个 $d$ 维向量 $x$ 的卷积操作可以用下式表示：


![image](https://cdn.jsdelivr.net/gh/ZhouKanglei/jidianxia/2021-3-26/1616756639294-image.png)

由于图像一般以固定的网格状的矩阵形式存储，因此在图像上，卷积核通常在`3×3，5×5`的固定网格上实现。在 CNN 中，不同的邻域采用同一个卷积核进行卷积，从而实现平移不变性。由此可见，图像上的卷积操作是连续卷积操作的一种特殊的离散化表示。

而点云具有更多的灵活的形状。点云中的点的坐标$p = (x，y，z)\in R_3$不位于固定网格上，但可以取任意连续值。因此，不同点的相对位置在每个局部区域是不同的。传统的离散卷积滤波不能直接应用于点云。

**图像网格与点云**：
(a)显示图像中的5×5局部区域，其中点之间的距离只能达到很少的离散值；(b)和(c)表明，在点云中的不同局部区域，顺序和相对位置可能非常不同。
![](https://cdn.jsdelivr.net/gh/ZhouKanglei/jidianxia/2021-3-26/1616756696482-image.png)

**点数转换的2D权函数**：(a)是学习的连续权重函数；
(b)和(c)是2D点云中不同的局部区域。
给定2D点，可以获得特定位置的权重。这同样适用于3D点。规则离散2D卷积可以看作是连续卷积权函数的离散化，如(d)所示。

![](https://cdn.jsdelivr.net/gh/ZhouKanglei/jidianxia/2021-3-26/1616756746154-image.png)



![](https://cdn.jsdelivr.net/gh/ZhouKanglei/jidianxia/2021-3-26/1616756891115-image.png)

#总结

**在《信号与系统》里面，卷积的含义是**：系统在t时刻的输出，不仅与系统在t时刻的输入有关，还与它在t时刻之前的输入有关，并且不同时刻的输入，有不同的权重。所以，卷积本质上做的事情是：不同时刻的输入的加权求和。权重是一个关于时间t的连续函数。

**把以上概念映射到2D图片卷积上**：对于2D图片来说，某个位置的输出，不仅与该位置的输入有关，还与此位置周边位置的输入有关，不同位置的输入，具有不同的权重。卷积所做的事情，同样是一个不同位置加权求和。由于位置坐标是固定的有限个值，所以，权重是一个关于位置的离散函数。现有的convolution操作实现了这个操作，只是并没有显式的将权重作为一个关于位置的函数，而是直接给每个位置设置一个权重系数。

**把以上概念映射到3D点云卷积上**：对于3D点云来说，某个位置的输出，不仅与该位置的输入有关，还与此位置点的K个最近的邻居点有关。位置具有随机性，取值空间在3D空间中是连续的。按照卷积的原理，不同位置的权重不同，所以，权重应该是一个关于3D坐标的连续函数。

